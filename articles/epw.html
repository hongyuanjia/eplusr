<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Work with weather files • eplusr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Work with weather files">
<meta property="og:description" content="eplusr">
<meta property="og:image" content="https://hongyuanjia.github.io/eplusr/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-141601756-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-141601756-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eplusr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/eplusr.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/eplusr.html">Introduction to eplusr</a>
    </li>
    <li>
      <a href="../articles/job.html">Run simulation and data exploration</a>
    </li>
    <li>
      <a href="../articles/param.html">Parametric simulations</a>
    </li>
    <li>
      <a href="../articles/transition.html">Update IDF version</a>
    </li>
    <li>
      <a href="../articles/epw.html">Work with weather files</a>
    </li>
    <li>
      <a href="../articles/schedule.html">Work with `Schedule:Compact` objects</a>
    </li>
    <li>
      <a href="../articles/geom.html">Work with geometries</a>
    </li>
    <li>
      <a href="../articles/faq.html">Frequently asked questions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Manual</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hongyuanjia/eplusr">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="epw_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Work with weather files</h1>
                        <h4 class="author">Hongyuan Jia</h4>
            
            <h4 class="date">2021-03-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hongyuanjia/eplusr/blob/master/vignettes/epw.Rmd"><code>vignettes/epw.Rmd</code></a></small>
      <div class="hidden name"><code>epw.Rmd</code></div>

    </div>

    
    
<p>This vignette introduces the <code>Epw</code> class which is designed to read and modify EnergyPlus Weather Files (EPWs).</p>
<hr>
<div id="download-energyplus-weather-file-epw-and-design-day-file-ddy" class="section level1">
<h1 class="hasAnchor">
<a href="#download-energyplus-weather-file-epw-and-design-day-file-ddy" class="anchor"></a>Download EnergyPlus Weather File (EPW) and Design Day File (DDY)</h1>
<p>eplusr contains a helper function <code><a href="../reference/download_weather.html">download_weather()</a></code> which can be used to download EnergyPlus EPW and DDY files from <a href="https://energyplus.net/weather">EnergyPlus weather website</a>.</p>
<p><code><a href="../reference/download_weather.html">download_weather()</a></code> takes a regular expression to search weather specifications and gives you a menu to choose files to download from matched results. Note that the matching is case-insensitive. Files downloaded will be renamed according to input <code>filename</code> argument.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/download_weather.html">download_weather</a></span><span class="op">(</span><span class="st">"los angeles"</span>, filename <span class="op">=</span> <span class="st">"Los Angeles"</span>, dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="co">#&gt; 3 matched results found. Please select which one to download:</span>
<span class="co">#&gt;</span>
<span class="co">#&gt; ── [1] USA_CA_Los.Angeles.722950_TMY2 ───────────────────</span>
<span class="co">#&gt;  * Country: United States of America</span>
<span class="co">#&gt;  * State or Province: CA</span>
<span class="co">#&gt;  * Location: CA_Los.Angeles</span>
<span class="co">#&gt;  * WMO number: 722950</span>
<span class="co">#&gt;  * Source type: TMY2</span>
<span class="co">#&gt;  * Longitude: -118.4</span>
<span class="co">#&gt;  * Latitude: 33.93</span>
<span class="co">#&gt;</span>
<span class="co">#&gt; ── [2] USA_CA_Los.Angeles.Intl.AP.722950_TMY ────────────</span>
<span class="co">#&gt;  * Country: United States of America</span>
<span class="co">#&gt;  * State or Province: CA</span>
<span class="co">#&gt;  * Location: CA_Los.Angeles.Intl.AP</span>
<span class="co">#&gt;  * WMO number: 722950</span>
<span class="co">#&gt;  * Source type: TMY</span>
<span class="co">#&gt;  * Longitude: -118.4</span>
<span class="co">#&gt;  * Latitude: 33.93</span>
<span class="co">#&gt;</span>
<span class="co">#&gt; ── [3] USA_CA_Los.Angeles.Intl.AP.722950_TMY3 ───────────</span>
<span class="co">#&gt;  * Country: United States of America</span>
<span class="co">#&gt;  * State or Province: CA</span>
<span class="co">#&gt;  * Location: CA_Los.Angeles.Intl.AP</span>
<span class="co">#&gt;  * WMO number: 722950</span>
<span class="co">#&gt;  * Source type: TMY3</span>
<span class="co">#&gt;  * Longitude: -118.4</span>
<span class="co">#&gt;  * Latitude: 33.93</span>
<span class="co">#&gt;</span>
<span class="co">#&gt; 1: USA_CA_Los.Angeles.722950_TMY2</span>
<span class="co">#&gt; 2: USA_CA_Los.Angeles.Intl.AP.722950_TMY</span>
<span class="co">#&gt; 3: USA_CA_Los.Angeles.Intl.AP.722950_TMY3</span>
<span class="co">#&gt; 4: All</span>
<span class="co">#&gt;</span>
<span class="co">#&gt; Selection:</span></code></pre></div>
<p>By default, it will download both EPW and DDY files of selected results. You can change that by modifying the <code>type</code> argument to only download either EPW files or DDY files.</p>
</div>
<div id="read-and-parse-epw" class="section level1">
<h1 class="hasAnchor">
<a href="#read-and-parse-epw" class="anchor"></a>Read and parse EPW</h1>
<p>Reading an EPW file starts with function <code><a href="../reference/read_epw.html">read_epw()</a></code>, which parses an EPW file and returns an <code>Epw</code> object. The parsing process is basically the same as <code>EnergyPlus/WeatherManager.cc</code> in EnergyPlus, with some simplifications.</p>
<p>An EPW file can be divided into two parts, headers and weather data. The first eight lines of a standard EPW file are normally headers which contains data of location, design conditions, typical/extreme periods, ground temperatures, holidays/daylight savings, data periods and other comments.</p>
<p><code>Epw</code> class provides methods to directly extract those data. For details on the data structure of EPW file, please see “Chapter 2 - Weather Converter Program” in EnergyPlus “Auxiliary Programs” documentation. An online version can be found <a href="https://bigladdersoftware.com/epx/docs/">here</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="../reference/use_eplus.html">eplus_config</a></span><span class="op">(</span><span class="fl">8.8</span><span class="op">)</span><span class="op">$</span><span class="va">dir</span>, <span class="st">"WeatherData/USA_CA_San.Francisco.Intl.AP.724940_TMY3.epw"</span><span class="op">)</span>

<span class="va">epw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_epw.html">read_epw</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span>
<span class="va">epw</span>
<span class="co">#&gt; ══ EnergyPlus Weather File ═════════════════════════════════════════════════════</span>
<span class="co">#&gt; [Location ]: San Francisco Intl Ap, CA, USA</span>
<span class="co">#&gt;              {N 37°37'}, {W 122°24'}, {UTC-08:00}</span>
<span class="co">#&gt; [Elevation]: 2m above see level</span>
<span class="co">#&gt; [Data Src ]: TMY3</span>
<span class="co">#&gt; [WMO Stat ]: 724940</span>
<span class="co">#&gt; [Leap Year]: No</span>
<span class="co">#&gt; [Interval ]: 60 mins</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Data Periods ────────────────────────────────────────────────────────────────</span>
<span class="co">#&gt;    Name StartDayOfWeek StartDay EndDay</span>
<span class="co">#&gt; 1: Data         Sunday     1/ 1  12/31</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span></code></pre></div>
</div>
<div id="extract-and-modify-header-data" class="section level1">
<h1 class="hasAnchor">
<a href="#extract-and-modify-header-data" class="anchor"></a>Extract and modify header data</h1>
<p><code>Epw</code> class provides 10 methods to extract and modify EPW header data, including:</p>
<table class="table">
<caption>Methods of <code>Epw</code> class to extract and modify headers</caption>
<thead><tr class="header">
<th align="left">Header</th>
<th align="left">Method</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>LOCATION</code></td>
<td align="left"><code>$location()</code></td>
</tr>
<tr class="even">
<td align="left"><code>DESIGN CONDITIONS</code></td>
<td align="left"><code>$design_condition()</code></td>
</tr>
<tr class="odd">
<td align="left"><code>TYPICAL/EXTREME PERIODS</code></td>
<td align="left"><code>$typical_extreme_period()</code></td>
</tr>
<tr class="even">
<td align="left"><code>GROUND TEMPERATURES</code></td>
<td align="left"><code>$ground_temperature()</code></td>
</tr>
<tr class="odd">
<td align="left"><code>HOLIDAYS/DAYLIGHT SAVINGS</code></td>
<td align="left"><code>$holiday()</code></td>
</tr>
<tr class="even">
<td align="left"><code>COMMENTS 1</code></td>
<td align="left"><code>$comment1()</code></td>
</tr>
<tr class="odd">
<td align="left"><code>COMMENTS 2</code></td>
<td align="left"><code>$comment2()</code></td>
</tr>
<tr class="even">
<td align="left"><code>DATA PERIODS</code></td>
<td align="left">
<code>$num_period()</code>, <code>$interval()</code> &amp; <code>$period()</code>
</td>
</tr>
</tbody>
</table>
</div>
<div id="extract-weather-data" class="section level1">
<h1 class="hasAnchor">
<a href="#extract-weather-data" class="anchor"></a>Extract weather data</h1>
<div id="core-data" class="section level2">
<h2 class="hasAnchor">
<a href="#core-data" class="anchor"></a>Core data</h2>
<p><code>$data()</code> can be used to extract the core weather data. Usually, EPW file downloaded from EnergyPlus website contains TMY weather data. As years of weather data is not consecutive, it may be more convenient to align the year values to be consecutive, which will makes it possible to direct analyze and plot weather data. The <code>start_year</code> argument in <code>$data()</code> method can help to achieve this. However, randomly setting the <code>year</code> may result in a date time series that does not have the same start day of week as specified in the <code>DATA PERIODS</code> header. eplusr provides a simple solution for this. By setting <code>year</code> to <code>NULL</code> and <code>align_wday</code> to <code>TRUE</code>, eplusr will calculate a year value (from current year backwards) for each data period that compliance with the start day of week restriction.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">epw</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Classes 'data.table' and 'data.frame':   6 obs. of  36 variables:</span>
<span class="co">#&gt;  $ datetime                                        : POSIXct, format: "2017-01-01 01:00:00" "2017-01-01 02:00:00" ...</span>
<span class="co">#&gt;  $ year                                            : int  1999 1999 1999 1999 1999 1999</span>
<span class="co">#&gt;  $ month                                           : int  1 1 1 1 1 1</span>
<span class="co">#&gt;  $ day                                             : int  1 1 1 1 1 1</span>
<span class="co">#&gt;  $ hour                                            : int  1 2 3 4 5 6</span>
<span class="co">#&gt;  $ minute                                          : int  0 0 0 0 0 0</span>
<span class="co">#&gt;  $ data_source                                     : chr  "?9?9?9?9E0?9?9?9?9?9?9?9?9?9?9?9?9?9?9?9*9*9?9?9?9" "?9?9?9?9E0?9?9?9?9?9?9?9?9?9?9?9?9?9?9?9*9*9?9?9?9" "?9?9?9?9E0?9?9?9?9?9?9?9?9?9?9?9?9?9?9?9*9*9?9?9?9" "?9?9?9?9E0?9?9?9?9?9?9?9?9?9?9?9?9?9?9?9*9*9?9?9?9" ...</span>
<span class="co">#&gt;  $ dry_bulb_temperature                            : num  7.2 7.2 6.7 6.1 4.4 4.4</span>
<span class="co">#&gt;  $ dew_point_temperature                           : num  5.6 5.6 5 5 3.9 3.9</span>
<span class="co">#&gt;  $ relative_humidity                               : num  90 90 89 93 97 97</span>
<span class="co">#&gt;  $ atmospheric_pressure                            : num  102200 102100 102200 102200 102200 ...</span>
<span class="co">#&gt;  $ extraterrestrial_horizontal_radiation           : num  0 0 0 0 0 0</span>
<span class="co">#&gt;  $ extraterrestrial_direct_normal_radiation        : num  0 0 0 0 0 0</span>
<span class="co">#&gt;  $ horizontal_infrared_radiation_intensity_from_sky: num  290 296 291 276 280 280</span>
<span class="co">#&gt;  $ global_horizontal_radiation                     : num  0 0 0 0 0 0</span>
<span class="co">#&gt;  $ direct_normal_radiation                         : num  0 0 0 0 0 0</span>
<span class="co">#&gt;  $ diffuse_horizontal_radiation                    : num  0 0 0 0 0 0</span>
<span class="co">#&gt;  $ global_horizontal_illuminance                   : num  0 0 0 0 0 0</span>
<span class="co">#&gt;  $ direct_normal_illuminance                       : num  0 0 0 0 0 0</span>
<span class="co">#&gt;  $ diffuse_horizontal_illuminance                  : num  0 0 0 0 0 0</span>
<span class="co">#&gt;  $ zenith_luminance                                : num  0 0 0 0 0 0</span>
<span class="co">#&gt;  $ wind_direction                                  : num  0 170 210 200 260 180</span>
<span class="co">#&gt;  $ wind_speed                                      : num  0 2.1 2.1 1.5 3.1 2.1</span>
<span class="co">#&gt;  $ total_sky_cover                                 : int  2 4 3 0 3 3</span>
<span class="co">#&gt;  $ opaque_sky_cover                                : int  2 4 3 0 3 3</span>
<span class="co">#&gt;  $ visibility                                      : num  16 16 16 16 16 16</span>
<span class="co">#&gt;  $ ceiling_height                                  : num  77777 77777 77777 77777 77777 ...</span>
<span class="co">#&gt;  $ present_weather_observation                     : int  9 9 9 9 9 9</span>
<span class="co">#&gt;  $ present_weather_codes                           : chr  "999999999" "999999999" "999999999" "999999999" ...</span>
<span class="co">#&gt;  $ precipitable_water                              : num  129 120 120 120 120 120</span>
<span class="co">#&gt;  $ aerosol_optical_depth                           : num  0.108 0.108 0.108 0.108 0.108 0.108</span>
<span class="co">#&gt;  $ snow_depth                                      : num  0 0 0 0 0 0</span>
<span class="co">#&gt;  $ days_since_last_snow                            : int  88 88 88 88 88 88</span>
<span class="co">#&gt;  $ albedo                                          : num  0.16 0.16 0.16 0.16 0.16 0.16</span>
<span class="co">#&gt;  $ liquid_precip_depth                             : num  0 0 0 0 0 0</span>
<span class="co">#&gt;  $ liquid_precip_rate                              : num  1 1 1 1 1 1</span>
<span class="co">#&gt;  - attr(*, ".internal.selfref")=&lt;externalptr&gt;</span></code></pre></div>
</div>
<div id="abnormal-data" class="section level2">
<h2 class="hasAnchor">
<a href="#abnormal-data" class="anchor"></a>Abnormal data</h2>
<p><code>$abnormal_data()</code> returns abnormal data of specific data period. Basically, there are 2 types of abnormal data in <code>Epw</code>, i.e. missing values and out-of-range values. Sometimes, it may be useful to extract and inspect those data especially when inserting measured weather data. <code>$abnormal_data()</code> does this.</p>
<p>In the returned <code>data.table</code>, a column named <code>line</code> is created indicating the line numbers where abnormal data occur in the actual EPW file.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">epw</span><span class="op">$</span><span class="fu">abnormal_data</span><span class="op">(</span>cols <span class="op">=</span> <span class="st">"albedo"</span>, keep_all <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;       line            datetime year month day hour minute albedo</span>
<span class="co">#&gt;    1:  753 1977-02-01 01:00:00 1977     2   1    1      0    999</span>
<span class="co">#&gt;    2:  754 1977-02-01 02:00:00 1977     2   1    2      0    999</span>
<span class="co">#&gt;    3:  755 1977-02-01 03:00:00 1977     2   1    3      0    999</span>
<span class="co">#&gt;    4:  756 1977-02-01 04:00:00 1977     2   1    4      0    999</span>
<span class="co">#&gt;    5:  757 1977-02-01 05:00:00 1977     2   1    5      0    999</span>
<span class="co">#&gt;   ---                                                           </span>
<span class="co">#&gt; 2156: 5836 1985-08-31 20:00:00 1985     8  31   20      0    999</span>
<span class="co">#&gt; 2157: 5837 1985-08-31 21:00:00 1985     8  31   21      0    999</span>
<span class="co">#&gt; 2158: 5838 1985-08-31 22:00:00 1985     8  31   22      0    999</span>
<span class="co">#&gt; 2159: 5839 1985-08-31 23:00:00 1985     8  31   23      0    999</span>
<span class="co">#&gt; 2160: 5840 1985-09-01 00:00:00 1985     8  31   24      0    999</span></code></pre></div>
<p>You can use <code>$make_na()</code> to turn all abnormal data into NAs:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">epw</span><span class="op">$</span><span class="fu">make_na</span><span class="op">(</span>missing <span class="op">=</span> <span class="cn">TRUE</span>, out_of_range <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">epw</span><span class="op">$</span><span class="fu">abnormal_data</span><span class="op">(</span>cols <span class="op">=</span> <span class="st">"albedo"</span>, keep_all <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;       line            datetime year month day hour minute albedo</span>
<span class="co">#&gt;    1:  753 1977-02-01 01:00:00 1977     2   1    1      0     NA</span>
<span class="co">#&gt;    2:  754 1977-02-01 02:00:00 1977     2   1    2      0     NA</span>
<span class="co">#&gt;    3:  755 1977-02-01 03:00:00 1977     2   1    3      0     NA</span>
<span class="co">#&gt;    4:  756 1977-02-01 04:00:00 1977     2   1    4      0     NA</span>
<span class="co">#&gt;    5:  757 1977-02-01 05:00:00 1977     2   1    5      0     NA</span>
<span class="co">#&gt;   ---                                                           </span>
<span class="co">#&gt; 2156: 5836 1985-08-31 20:00:00 1985     8  31   20      0     NA</span>
<span class="co">#&gt; 2157: 5837 1985-08-31 21:00:00 1985     8  31   21      0     NA</span>
<span class="co">#&gt; 2158: 5838 1985-08-31 22:00:00 1985     8  31   22      0     NA</span>
<span class="co">#&gt; 2159: 5839 1985-08-31 23:00:00 1985     8  31   23      0     NA</span>
<span class="co">#&gt; 2160: 5840 1985-09-01 00:00:00 1985     8  31   24      0     NA</span></code></pre></div>
<p>Or use <code>$fill_abnormal()</code> to fill NAs back to missing codes:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">epw</span><span class="op">$</span><span class="fu">fill_abnormal</span><span class="op">(</span>missing <span class="op">=</span> <span class="cn">TRUE</span>, out_of_range <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">epw</span><span class="op">$</span><span class="fu">abnormal_data</span><span class="op">(</span>cols <span class="op">=</span> <span class="st">"albedo"</span>, keep_all <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;       line            datetime year month day hour minute albedo</span>
<span class="co">#&gt;    1:  753 1977-02-01 01:00:00 1977     2   1    1      0    999</span>
<span class="co">#&gt;    2:  754 1977-02-01 02:00:00 1977     2   1    2      0    999</span>
<span class="co">#&gt;    3:  755 1977-02-01 03:00:00 1977     2   1    3      0    999</span>
<span class="co">#&gt;    4:  756 1977-02-01 04:00:00 1977     2   1    4      0    999</span>
<span class="co">#&gt;    5:  757 1977-02-01 05:00:00 1977     2   1    5      0    999</span>
<span class="co">#&gt;   ---                                                           </span>
<span class="co">#&gt; 2156: 5836 1985-08-31 20:00:00 1985     8  31   20      0    999</span>
<span class="co">#&gt; 2157: 5837 1985-08-31 21:00:00 1985     8  31   21      0    999</span>
<span class="co">#&gt; 2158: 5838 1985-08-31 22:00:00 1985     8  31   22      0    999</span>
<span class="co">#&gt; 2159: 5839 1985-08-31 23:00:00 1985     8  31   23      0    999</span>
<span class="co">#&gt; 2160: 5840 1985-09-01 00:00:00 1985     8  31   24      0    999</span></code></pre></div>
</div>
</div>
<div id="modify-weather-data" class="section level1">
<h1 class="hasAnchor">
<a href="#modify-weather-data" class="anchor"></a>Modify weather data</h1>
<p><code>Epw</code> class provides <code>$add()</code>, <code>$set()</code> and <code>$del()</code> methods to add, update and delete a new data period, respectively.</p>
<p>Below we extract weather data with automatically calculated year values, and replace the existing data and turn it into an AMY weather data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">epw</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">d</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">datetime</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;                  datetime</span>
<span class="co">#&gt;    1: 2017-01-01 01:00:00</span>
<span class="co">#&gt;    2: 2017-01-01 02:00:00</span>
<span class="co">#&gt;    3: 2017-01-01 03:00:00</span>
<span class="co">#&gt;    4: 2017-01-01 04:00:00</span>
<span class="co">#&gt;    5: 2017-01-01 05:00:00</span>
<span class="co">#&gt;   ---                    </span>
<span class="co">#&gt; 8756: 2017-12-31 20:00:00</span>
<span class="co">#&gt; 8757: 2017-12-31 21:00:00</span>
<span class="co">#&gt; 8758: 2017-12-31 22:00:00</span>
<span class="co">#&gt; 8759: 2017-12-31 23:00:00</span>
<span class="co">#&gt; 8760: 2018-01-01 00:00:00</span>

<span class="va">epw</span><span class="op">$</span><span class="fu">set</span><span class="op">(</span><span class="va">d</span>, realyear <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; ── Info ────────────────────────────────────────────────────────────────────────</span>
<span class="co">#&gt; Data period #1 has been replaced with input data.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      Name StartDayOfWeek   StartDay     EndDay</span>
<span class="co">#&gt;  1:  Data         Sunday 2017/ 1/ 1 2017/12/31</span>
<span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span></code></pre></div>
<p><code>Epw</code> class supports multiple data periods in a single EPW file:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">epw</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span>start_year <span class="op">=</span> <span class="fl">2014</span>, align_wday <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Warning: Data period #1 'Data' seems like a real-year data starting from 2017/</span>
<span class="co">#&gt; 1/ 1 to 2017/12/31. The starting date will be overwriten as 2014/ 1/ 1.</span>

<span class="va">epw</span><span class="op">$</span><span class="fu">add</span><span class="op">(</span><span class="va">d</span>, after <span class="op">=</span> <span class="fl">0L</span>, realyear <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; ── Info ────────────────────────────────────────────────────────────────────────</span>
<span class="co">#&gt; New data period has been added successfully:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       Name StartDayOfWeek   StartDay     EndDay</span>
<span class="co">#&gt;  1:  Data1      Wednesday 2014/ 1/ 1 2014/12/31</span>
<span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span>

<span class="va">epw</span><span class="op">$</span><span class="fu">period</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt;    index  name start_day_of_week  start_day    end_day</span>
<span class="co">#&gt; 1:     1 Data1         Wednesday 2014/ 1/ 1 2014/12/31</span>
<span class="co">#&gt; 2:     2  Data            Sunday 2017/ 1/ 1 2017/12/31</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/hongyuanjia">Hongyuan Jia</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '158ff4599f27d2efdd371e5200cdb538',
    indexName: 'eplusr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
